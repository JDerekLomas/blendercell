<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>PlasmaCell - The Antibody Story</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            slate: {
              50: '#f8fafc',
              100: '#f1f5f9',
              200: '#e2e8f0',
              300: '#cbd5e1',
              400: '#94a3b8',
              500: '#64748b',
              600: '#475569',
              700: '#334155',
              800: '#1e293b',
              900: '#0f172a',
              950: '#020617',
            }
          }
        }
      }
    }
  </script>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    body {
      font-family: system-ui, -apple-system, sans-serif;
      overflow: hidden;
      background: #020617;
    }
    #canvas-container {
      width: 100vw;
      height: 100vh;
      position: fixed;
      top: 0;
      left: 0;
    }

    /* Custom scrollbar */
    .custom-scrollbar::-webkit-scrollbar {
      width: 8px;
    }
    .custom-scrollbar::-webkit-scrollbar-track {
      background: rgba(30, 41, 59, 0.5);
      border-radius: 4px;
    }
    .custom-scrollbar::-webkit-scrollbar-thumb {
      background: rgba(20, 184, 166, 0.5);
      border-radius: 4px;
    }
    .custom-scrollbar::-webkit-scrollbar-thumb:hover {
      background: rgba(20, 184, 166, 0.7);
    }

    /* Animations */
    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }
    @keyframes slideUp {
      from { transform: translateY(20px); opacity: 0; }
      to { transform: translateY(0); opacity: 1; }
    }
    @keyframes slideDown {
      from { transform: translateY(-20px); opacity: 0; }
      to { transform: translateY(0); opacity: 1; }
    }
    @keyframes zoomIn {
      from { transform: scale(0.95); opacity: 0; }
      to { transform: scale(1); opacity: 1; }
    }
    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.5; }
    }
    .animate-fade-in { animation: fadeIn 0.5s ease-out; }
    .animate-slide-up { animation: slideUp 0.7s ease-out; }
    .animate-slide-down { animation: slideDown 0.7s ease-out; }
    .animate-zoom-in { animation: zoomIn 0.5s ease-out; }
    .animate-pulse-custom { animation: pulse 2s ease-in-out infinite; }

    /* Label styling */
    .organelle-label {
      position: absolute;
      pointer-events: none;
      transform: translate(-50%, -100%);
      z-index: 100;
    }
    .label-container {
      background: rgba(15, 23, 42, 0.95);
      backdrop-filter: blur(12px);
      color: #f0fdfa;
      font-size: 14px;
      font-weight: 700;
      padding: 8px 16px;
      border-radius: 12px;
      border: 2px solid rgba(20, 184, 166, 0.5);
      box-shadow: 0 0 30px rgba(20, 184, 166, 0.4);
      white-space: nowrap;
      letter-spacing: 0.5px;
      margin-bottom: 4px;
    }
    .label-line {
      width: 2px;
      height: 32px;
      background: linear-gradient(to bottom, #14b8a6, transparent);
      margin: 0 auto;
    }
    .label-dot {
      width: 12px;
      height: 12px;
      background: #2dd4bf;
      border-radius: 50%;
      margin: 0 auto;
      box-shadow: 0 0 15px rgba(20, 184, 166, 1);
      border: 2px solid rgba(255, 255, 255, 0.2);
    }

    /* Glow effects */
    .glow-teal {
      box-shadow: 0 0 50px rgba(20, 184, 166, 0.2);
    }
    .glow-button:hover {
      box-shadow: 0 0 30px rgba(20, 184, 166, 0.6);
    }
  </style>
</head>
<body class="bg-slate-950">
  <div id="canvas-container"></div>

  <!-- Intro Modal -->
  <div id="intro-modal" class="fixed inset-0 z-50 flex items-center justify-center bg-slate-950/95 backdrop-blur-md p-6">
    <div class="max-w-2xl w-full bg-slate-900 border border-teal-500/30 rounded-3xl p-10 glow-teal text-center animate-zoom-in">
      <div class="mb-6 flex justify-center">
        <div class="w-20 h-20 rounded-full bg-teal-900/50 flex items-center justify-center border-2 border-teal-500 animate-pulse">
          <svg class="text-teal-400 w-10 h-10" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"/>
          </svg>
        </div>
      </div>
      <h1 class="text-5xl font-bold text-white mb-2 tracking-tight">
        Meet the <span class="text-transparent bg-clip-text bg-gradient-to-r from-teal-400 to-emerald-400">Plasma Cell</span>
      </h1>
      <h2 class="text-xl text-teal-200/80 font-medium mb-8">The Immune System's Antibody Factory</h2>

      <p class="text-slate-300 text-lg leading-relaxed mb-10 max-w-lg mx-auto">
        You are about to explore a specialized biological factory. Unlike regular cells, this machine has evolved for one purpose: speed.
        <br><br>
        <span class="text-teal-400 font-semibold">It produces thousands of antibodies per second</span> to hunt down invaders.
      </p>

      <button id="start-btn" class="group bg-gradient-to-r from-teal-500 to-emerald-500 hover:from-teal-400 hover:to-emerald-400 text-white text-lg font-bold px-10 py-4 rounded-full shadow-lg glow-button transition-all duration-300 flex items-center gap-3 mx-auto">
        <svg class="w-6 h-6 group-hover:scale-110 transition-transform" fill="currentColor" viewBox="0 0 24 24">
          <path d="M8 5v14l11-7z"/>
        </svg>
        Start Exploration
      </button>
    </div>
  </div>

  <!-- UI Overlay -->
  <div id="ui-overlay" class="fixed inset-0 pointer-events-none z-10 flex flex-col p-6 hidden">

    <!-- Top Header -->
    <div class="pointer-events-auto flex justify-between items-start mb-auto animate-slide-down">
      <div>
        <h1 class="text-4xl font-light text-white tracking-wider drop-shadow-md">
          PLASMA<span class="font-bold text-teal-400">CELL</span>
        </h1>
        <p class="text-teal-200/70 text-sm mt-1">The Antibody Story</p>
      </div>

      <div class="flex gap-2">
        <button id="er-settings-btn" class="bg-slate-900/80 border border-teal-500/50 text-teal-300 px-4 py-2 rounded-full text-sm hover:bg-teal-600 hover:text-white transition-colors shadow-lg flex items-center gap-2">
          <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4"/>
          </svg>
          ER Tuning
        </button>
        <button id="reset-btn" class="bg-slate-900/80 border border-slate-600 text-white px-4 py-2 rounded-full text-sm hover:bg-slate-800 transition-colors shadow-lg opacity-0 pointer-events-none">
          Reset View
        </button>
      </div>
    </div>

    <!-- Bottom Bar -->
    <div class="w-full flex justify-between items-end relative animate-slide-up">
      <!-- Left: Info Button -->
      <div class="pointer-events-auto">
        <button id="info-btn" class="group flex items-center gap-3 bg-slate-900/90 hover:bg-teal-600 border border-teal-500/50 hover:border-teal-400 text-teal-50 px-5 py-3 rounded-full shadow-lg transition-all duration-300 backdrop-blur-md">
          <svg class="w-5 h-5 group-hover:scale-110 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
          </svg>
          <span class="font-semibold tracking-wide hidden sm:inline">The Story</span>
        </button>
      </div>

      <!-- Center: Hint -->
      <div id="hint-container" class="pointer-events-none absolute left-1/2 bottom-0 transform -translate-x-1/2 transition-all duration-500">
        <div class="bg-slate-900/60 backdrop-blur-md border border-white/10 text-slate-200 px-6 py-3 rounded-full flex items-center gap-3 shadow-2xl animate-pulse">
          <svg class="w-5 h-5 text-teal-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 15l-2 5L9 9l11 4-5 2zm0 0l5 5M7.188 2.239l.777 2.897M5.136 7.965l-2.898-.777M13.95 4.05l-2.122 2.122m-5.657 5.656l-2.12 2.122"/>
          </svg>
          <span class="text-sm font-medium tracking-wide">Click organelles to identify</span>
        </div>
      </div>

      <!-- Right: Zoom Controls -->
      <div class="pointer-events-auto flex flex-col items-end gap-3">
        <div class="flex gap-2">
          <button id="zoom-in-btn" class="bg-slate-900/90 hover:bg-teal-600 border border-teal-500/50 hover:border-teal-400 text-teal-50 p-3 rounded-full shadow-lg transition-all duration-300 backdrop-blur-md">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0zM10 7v6m3-3H7"/>
            </svg>
          </button>
          <button id="zoom-out-btn" class="bg-slate-900/90 hover:bg-teal-600 border border-teal-500/50 hover:border-teal-400 text-teal-50 p-3 rounded-full shadow-lg transition-all duration-300 backdrop-blur-md">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0zM13 10H7"/>
            </svg>
          </button>
        </div>
        <div class="bg-slate-900/60 backdrop-blur-md border border-white/10 text-slate-300 px-4 py-2 rounded-lg text-xs flex items-center gap-2">
          <svg class="w-4 h-4 text-teal-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"/>
          </svg>
          <span>Scroll to zoom | Drag to rotate</span>
        </div>
      </div>
    </div>
  </div>

  <!-- Info Modal -->
  <div id="info-modal" class="fixed inset-0 z-50 bg-black/80 backdrop-blur-sm flex items-center justify-center p-4 hidden">
    <div class="bg-slate-900 border border-teal-500/30 w-full max-w-4xl rounded-2xl shadow-2xl flex flex-col overflow-hidden animate-zoom-in" style="max-height: 85vh;">
      <!-- Modal Header -->
      <div class="flex justify-between items-center p-6 border-b border-slate-800 bg-slate-950/50">
        <div class="flex items-center gap-3">
          <svg class="w-6 h-6 text-teal-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"/>
          </svg>
          <h2 class="text-2xl font-bold text-white">The Antibody Story</h2>
        </div>
        <button id="close-info-btn" class="text-slate-400 hover:text-white transition-colors">
          <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
          </svg>
        </button>
      </div>

      <!-- Modal Content -->
      <div class="p-8 overflow-y-auto space-y-8 custom-scrollbar">
        <!-- General Intro -->
        <div class="bg-teal-900/20 border border-teal-500/20 rounded-xl p-6">
          <h3 class="text-xl font-bold text-teal-300 mb-2">Follow the Journey</h3>
          <p class="text-slate-300 leading-relaxed mb-4">You're about to follow an antibody from its very first moment as genetic code to its release into the bloodstream. Click on each organelle to discover its role in this incredible story of molecular manufacturing.</p>
          <p class="text-teal-100 font-medium italic">The path: DNA → mRNA → Protein → Packaging → Release → Attack!</p>
        </div>

        <!-- Organelle Grid -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4" id="organelle-grid">
          <!-- Dynamically populated -->
        </div>
      </div>
    </div>
  </div>

  <!-- Label Container (for 3D labels) -->
  <div id="label-container"></div>

  <!-- Organelle Info Popup (shown when clicking organelle/label) - Fixed position on left side -->
  <div id="organelle-popup" class="fixed left-6 top-1/2 -translate-y-1/2 z-40 hidden">
    <div class="bg-slate-900/95 backdrop-blur-md border border-teal-500/50 rounded-2xl shadow-2xl w-80 overflow-hidden animate-zoom-in">
      <!-- Popup Header -->
      <div class="bg-gradient-to-r from-teal-600 to-emerald-600 px-5 py-4 flex justify-between items-center">
        <h3 id="popup-title" class="text-lg font-bold text-white">Organelle Name</h3>
        <button id="close-popup-btn" class="text-white/80 hover:text-white transition-colors">
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
          </svg>
        </button>
      </div>
      <!-- Popup Content -->
      <div class="p-5 space-y-3">
        <p id="popup-description" class="text-slate-300 text-sm leading-relaxed"></p>
        <div class="bg-teal-900/30 border border-teal-500/20 rounded-lg p-3">
          <p class="text-xs text-teal-400 uppercase font-semibold mb-1">Function</p>
          <p id="popup-function" class="text-teal-100 text-sm"></p>
        </div>
      </div>
    </div>
  </div>

  <!-- ER Parameters Panel -->
  <div id="er-panel" class="fixed top-20 right-6 z-40 bg-slate-900/95 backdrop-blur-md border border-teal-500/30 rounded-xl p-4 w-72 hidden shadow-2xl">
    <div class="flex justify-between items-center mb-4">
      <h3 class="text-sm font-bold text-teal-300 uppercase tracking-wide">ER Parameters</h3>
      <button id="close-er-panel" class="text-slate-400 hover:text-white">
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
        </svg>
      </button>
    </div>

    <div class="space-y-4">
      <!-- Fold Count -->
      <div>
        <label class="flex justify-between text-xs text-slate-400 mb-1">
          <span>Fold Count</span>
          <span id="fold-value" class="text-teal-300">34</span>
        </label>
        <input type="range" id="fold-slider" min="2" max="50" value="34" class="w-full h-2 bg-slate-700 rounded-lg appearance-none cursor-pointer accent-teal-500">
      </div>

      <!-- Fold Amplitude -->
      <div>
        <label class="flex justify-between text-xs text-slate-400 mb-1">
          <span>Fold Amplitude</span>
          <span id="amp-value" class="text-teal-300">0.82</span>
        </label>
        <input type="range" id="amp-slider" min="5" max="150" value="82" class="w-full h-2 bg-slate-700 rounded-lg appearance-none cursor-pointer accent-teal-500">
      </div>

      <!-- Smoothness -->
      <div>
        <label class="flex justify-between text-xs text-slate-400 mb-1">
          <span>Smoothness</span>
          <span id="smooth-value" class="text-teal-300">48</span>
        </label>
        <input type="range" id="smooth-slider" min="20" max="200" value="48" class="w-full h-2 bg-slate-700 rounded-lg appearance-none cursor-pointer accent-teal-500">
      </div>

      <!-- Tube Thickness -->
      <div>
        <label class="flex justify-between text-xs text-slate-400 mb-1">
          <span>Tube Thickness</span>
          <span id="tube-value" class="text-teal-300">0.40</span>
        </label>
        <input type="range" id="tube-slider" min="5" max="50" value="40" class="w-full h-2 bg-slate-700 rounded-lg appearance-none cursor-pointer accent-teal-500">
      </div>

      <!-- ER Opacity -->
      <div>
        <label class="flex justify-between text-xs text-slate-400 mb-1">
          <span>ER Opacity</span>
          <span id="opacity-value" class="text-teal-300">0.20</span>
        </label>
        <input type="range" id="opacity-slider" min="5" max="100" value="20" class="w-full h-2 bg-slate-700 rounded-lg appearance-none cursor-pointer accent-teal-500">
      </div>

      <!-- Membrane Opacity -->
      <div>
        <label class="flex justify-between text-xs text-slate-400 mb-1">
          <span>Membrane Opacity</span>
          <span id="membrane-value" class="text-teal-300">0.10</span>
        </label>
        <input type="range" id="membrane-slider" min="2" max="60" value="10" class="w-full h-2 bg-slate-700 rounded-lg appearance-none cursor-pointer accent-teal-500">
      </div>

      <!-- Regenerate Button -->
      <button id="regenerate-er-btn" class="w-full bg-teal-600 hover:bg-teal-500 text-white text-sm font-semibold py-2 px-4 rounded-lg transition-colors mt-2">
        Regenerate ER
      </button>
    </div>
  </div>

  <script type="module" src="/src/main.js"></script>
</body>
</html>
